a : arch,
ws : weights a,
x_data : T [a.n_in, a.n_x]
⊢ (T.is_uniformly_integrable_around
         (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
            T.mvn_iso_pdf 0 1 x ⬝
              (T.mvn_iso_kl
                   (T.gemm (ws.W_encode_μ)
                      (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                   (T.sqrt
                      (T.exp
                         (T.gemm (ws.W_encode_logσ₂)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                 T.bernoulli_neglogpdf
                   (T.sigmoid
                      (T.gemm (ws.W_decode_p)
                         (T.softplus
                            (T.gemm θ₀
                               (x *
                                    T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                  T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
         (ws.W_decode) ∧
       T.is_uniformly_integrable_around
         (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
            T.mvn_iso_pdf 0 1 x ⬝
              (T.mvn_iso_kl
                   (T.gemm (ws.W_encode_μ)
                      (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                   (T.sqrt
                      (T.exp
                         (T.gemm (ws.W_encode_logσ₂)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                 T.bernoulli_neglogpdf
                   (T.sigmoid
                      (T.gemm (ws.W_decode_p)
                         (T.softplus
                            (T.gemm θ₀
                               (x *
                                    T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                  T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
         (ws.W_decode)) ∧
    (T.is_uniformly_integrable_around
           (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
              ∇
                (λ (θ₁ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)),
                   T.mvn_iso_pdf 0 1 x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm (ws.W_decode_p)
                                (T.softplus
                                   (T.gemm θ₁
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                θ₀)
           (ws.W_decode) ∧
         T.is_uniformly_integrable_around
           (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
              ∇
                (λ (θ₁ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)),
                   T.mvn_iso_pdf 0 1 x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm (ws.W_decode_p)
                                (T.softplus
                                   (T.gemm θ₁
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                θ₀)
           (ws.W_decode)) ∧
      (∀ (idx : ℕ),
           at_idx nil idx (ID.str label.W_decode, [a.nd, a.nz]) →
           T.is_uniformly_integrable_around
             (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                  (T.mvn_iso_kl
                       (T.gemm (ws.W_encode_μ)
                          (T.softplus
                             (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                       (T.sqrt
                          (T.exp
                             (T.gemm (ws.W_encode_logσ₂)
                                (T.softplus
                                   (T.gemm (ws.W_encode)
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                     T.bernoulli_neglogpdf
                       (T.sigmoid
                          (T.gemm (ws.W_decode_p)
                             (T.softplus
                                (T.gemm (ws.W_decode)
                                   (x *
                                        T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                      T.gemm (ws.W_encode_μ)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
             (ws.W_decode)) ∧
        ∀ (idx : ℕ),
          at_idx nil idx (ID.str label.W_decode, [a.nd, a.nz]) →
          T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               ∇
                 (λ (θ₀ : T ((ID.str label.W_decode, [a.nd, a.nz]).snd)),
                    rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                      (T.mvn_iso_kl
                           (T.gemm (ws.W_encode_μ)
                              (T.softplus
                                 (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                           (T.sqrt
                              (T.exp
                                 (T.gemm (ws.W_encode_logσ₂)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                         T.bernoulli_neglogpdf
                           (T.sigmoid
                              (T.gemm (ws.W_decode_p)
                                 (T.softplus
                                    (T.gemm (ws.W_decode)
                                       (x *
                                            T.sqrt
                                              (T.exp
                                                 (T.gemm (ws.W_encode_logσ₂)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))) +
                                          T.gemm (ws.W_encode_μ)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                 θ₀)
            (ws.W_decode)
-------------------------------------

a : arch,
ws : weights a,
x_data : T [a.n_in, a.n_x]
⊢ ((T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd))
             (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               T.mvn_iso_pdf 0 1 x ⬝
                 (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                    T.bernoulli_neglogpdf
                      (T.sigmoid
                         (T.gemm (ws.W_decode_p)
                            (T.softplus
                               (T.gemm (ws.W_decode)
                                  (x *
                                       T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                     T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
            (ws.W_encode_μ) ∧
          T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd))
             (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               T.mvn_iso_pdf 0 1 x ⬝
                 (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                    T.bernoulli_neglogpdf
                      (T.sigmoid
                         (T.gemm (ws.W_decode_p)
                            (T.softplus
                               (T.gemm (ws.W_decode)
                                  (x *
                                       T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                     T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
            (ws.W_encode_μ)) ∧
       (T.is_uniformly_integrable_around
              (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd))
               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                 ∇
                   (λ (θ₁ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd)),
                      T.mvn_iso_pdf 0 1 x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   θ₀)
              (ws.W_encode_μ) ∧
            T.is_uniformly_integrable_around
              (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd))
               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                 ∇
                   (λ (θ₁ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd)),
                      T.mvn_iso_pdf 0 1 x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   θ₀)
              (ws.W_encode_μ)) ∧
         (∀ (idx : ℕ),
              at_idx nil idx (ID.str label.W_encode_μ, [a.nz, a.ne]) →
              T.is_uniformly_integrable_around
                (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd))
                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                   rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm (ws.W_decode_p)
                                (T.softplus
                                   (T.gemm (ws.W_decode)
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                (ws.W_encode_μ)) ∧
           ∀ (idx : ℕ),
             at_idx nil idx (ID.str label.W_encode_μ, [a.nz, a.ne]) →
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd))
                (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  ∇
                    (λ (θ₀ : T ((ID.str label.W_encode_μ, [a.nz, a.ne]).snd)),
                       rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                           x ⬝
                         (T.mvn_iso_kl
                              (T.gemm (ws.W_encode_μ)
                                 (T.softplus
                                    (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                              (T.sqrt
                                 (T.exp
                                    (T.gemm (ws.W_encode_logσ₂)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                            T.bernoulli_neglogpdf
                              (T.sigmoid
                                 (T.gemm (ws.W_decode_p)
                                    (T.softplus
                                       (T.gemm (ws.W_decode)
                                          (x *
                                               T.sqrt
                                                 (T.exp
                                                    (T.gemm (ws.W_encode_logσ₂)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))) +
                                             T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                    θ₀)
               (ws.W_encode_μ)) ∧
    (true →
     ((T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (T.mvn_iso_kl
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        θ₀)))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.gemm (ws.W_encode_μ)
                  (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (T.mvn_iso_kl
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        θ₀)))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.gemm (ws.W_encode_μ)
                  (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
          (T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.str label.μ, [a.nz, a.bs]).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               θ₁)))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.gemm (ws.W_encode_μ)
                    (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
               T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.str label.μ, [a.nz, a.bs]).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               θ₁)))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.gemm (ws.W_encode_μ)
                    (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
            (∀ (idx : ℕ),
                 at_idx nil idx (ID.str label.μ, [a.nz, a.bs]) →
                 T.is_uniformly_integrable_around
                   (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                      rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                          x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   (T.gemm (ws.W_encode_μ)
                      (T.softplus
                         (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
              ∀ (idx : ℕ),
                at_idx nil idx (ID.str label.μ, [a.nz, a.bs]) →
                T.is_uniformly_integrable_around
                  (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                     ∇
                       (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)),
                          rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                              x ⬝
                            (T.mvn_iso_kl
                                 (T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                               T.bernoulli_neglogpdf
                                 (T.sigmoid
                                    (T.gemm (ws.W_decode_p)
                                       (T.softplus
                                          (T.gemm (ws.W_decode)
                                             (x *
                                                  T.sqrt
                                                    (T.exp
                                                       (T.gemm (ws.W_encode_logσ₂)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))) +
                                                T.gemm (ws.W_encode_μ)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start))))))))))
                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                       θ₀)
                  (T.gemm (ws.W_encode_μ)
                     (T.softplus
                        (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
       (true →
        (T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (θ₀ +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.mvn_iso_kl
                  (T.gemm (ws.W_encode_μ)
                     (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                  (T.sqrt
                     (T.exp
                        (T.gemm (ws.W_encode_logσ₂)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (θ₀ +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.mvn_iso_kl
                  (T.gemm (ws.W_encode_μ)
                     (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                  (T.sqrt
                     (T.exp
                        (T.gemm (ws.W_encode_logσ₂)
                           (T.softplus
                              (T.gemm (ws.W_encode)
                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
          (T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                  (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (θ₁ +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.mvn_iso_kl
                    (T.gemm (ws.W_encode_μ)
                       (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                    (T.sqrt
                       (T.exp
                          (T.gemm (ws.W_encode_logσ₂)
                             (T.softplus
                                (T.gemm (ws.W_encode)
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
               T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                  (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (θ₁ +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.mvn_iso_kl
                    (T.gemm (ws.W_encode_μ)
                       (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                    (T.sqrt
                       (T.exp
                          (T.gemm (ws.W_encode_logσ₂)
                             (T.softplus
                                (T.gemm (ws.W_encode)
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
            (∀ (idx : ℕ),
                 at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                 T.is_uniformly_integrable_around
                   (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                    (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                      rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                          x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
              ∀ (idx : ℕ),
                at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                T.is_uniformly_integrable_around
                  (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                   (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                     ∇
                       (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                          rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                              x ⬝
                            (T.mvn_iso_kl
                                 (T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                               T.bernoulli_neglogpdf
                                 (T.sigmoid
                                    (T.gemm (ws.W_decode_p)
                                       (T.softplus
                                          (T.gemm (ws.W_decode)
                                             (x *
                                                  T.sqrt
                                                    (T.exp
                                                       (T.gemm (ws.W_encode_logσ₂)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))) +
                                                T.gemm (ws.W_encode_μ)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start))))))))))
                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                       θ₀)
                  (T.mvn_iso_kl
                     (T.gemm (ws.W_encode_μ)
                        (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                     (T.sqrt
                        (T.exp
                           (T.gemm (ws.W_encode_logσ₂)
                              (T.softplus
                                 (T.gemm (ws.W_encode)
                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))))
----------------------------------
a : arch,
ws : weights a,
x_data : T [a.n_in, a.n_x]
⊢ ((T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               T.mvn_iso_pdf 0 1 x ⬝
                 (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                    T.bernoulli_neglogpdf
                      (T.sigmoid
                         (T.gemm (ws.W_decode_p)
                            (T.softplus
                               (T.gemm (ws.W_decode)
                                  (x *
                                       T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                     T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
            (ws.W_encode) ∧
          T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               T.mvn_iso_pdf 0 1 x ⬝
                 (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                    T.bernoulli_neglogpdf
                      (T.sigmoid
                         (T.gemm (ws.W_decode_p)
                            (T.softplus
                               (T.gemm (ws.W_decode)
                                  (x *
                                       T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                     T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
            (ws.W_encode)) ∧
       (T.is_uniformly_integrable_around
              (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd))
               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                 ∇
                   (λ (θ₁ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd)),
                      T.mvn_iso_pdf 0 1 x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   θ₀)
              (ws.W_encode) ∧
            T.is_uniformly_integrable_around
              (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd))
               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                 ∇
                   (λ (θ₁ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd)),
                      T.mvn_iso_pdf 0 1 x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   θ₀)
              (ws.W_encode)) ∧
         (∀ (idx : ℕ),
              at_idx nil idx (ID.str label.W_encode, [a.ne, a.n_in]) →
              T.is_uniformly_integrable_around
                (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd))
                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                   rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm (ws.W_decode_p)
                                (T.softplus
                                   (T.gemm (ws.W_decode)
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                (ws.W_encode)) ∧
           ∀ (idx : ℕ),
             at_idx nil idx (ID.str label.W_encode, [a.ne, a.n_in]) →
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd))
                (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  ∇
                    (λ (θ₀ : T ((ID.str label.W_encode, [a.ne, a.n_in]).snd)),
                       rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                           x ⬝
                         (T.mvn_iso_kl
                              (T.gemm (ws.W_encode_μ)
                                 (T.softplus
                                    (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                              (T.sqrt
                                 (T.exp
                                    (T.gemm (ws.W_encode_logσ₂)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                            T.bernoulli_neglogpdf
                              (T.sigmoid
                                 (T.gemm (ws.W_decode_p)
                                    (T.softplus
                                       (T.gemm (ws.W_decode)
                                          (x *
                                               T.sqrt
                                                 (T.exp
                                                    (T.gemm (ws.W_encode_logσ₂)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))) +
                                             T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                    θ₀)
               (ws.W_encode)) ∧
    (true →
     ((T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (T.mvn_iso_kl
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))) ∧
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (T.mvn_iso_kl
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))) ∧
          (T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.nat 2, [a.ne, a.bs]).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))) ∧
               T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.nat 2, [a.ne, a.bs]).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))) ∧
            (∀ (idx : ℕ),
                 at_idx nil idx (ID.nat 2, [a.ne, a.bs]) →
                 T.is_uniformly_integrable_around
                   (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                      rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                          x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))) ∧
              ∀ (idx : ℕ),
                at_idx nil idx (ID.nat 2, [a.ne, a.bs]) →
                T.is_uniformly_integrable_around
                  (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                     ∇
                       (λ (θ₀ : T ((ID.nat 2, [a.ne, a.bs]).snd)),
                          rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                              x ⬝
                            (T.mvn_iso_kl
                                 (T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                               T.bernoulli_neglogpdf
                                 (T.sigmoid
                                    (T.gemm (ws.W_decode_p)
                                       (T.softplus
                                          (T.gemm (ws.W_decode)
                                             (x *
                                                  T.sqrt
                                                    (T.exp
                                                       (T.gemm (ws.W_encode_logσ₂)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))) +
                                                T.gemm (ws.W_encode_μ)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start))))))))))
                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                       θ₀)
                  (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))) ∧
       (true →
        (((T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (T.mvn_iso_kl
                               (T.gemm (ws.W_encode_μ)
                                  (T.softplus
                                     (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                               (T.sqrt
                                  (T.exp
                                     (T.gemm (ws.W_encode_logσ₂)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))) ∧
                   T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (T.mvn_iso_kl
                               (T.gemm (ws.W_encode_μ)
                                  (T.softplus
                                     (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                               (T.sqrt
                                  (T.exp
                                     (T.gemm (ws.W_encode_logσ₂)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                (T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.softplus
                          (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))) ∧
                     T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.softplus
                          (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                  (∀ (idx : ℕ),
                       at_idx nil idx (ID.str label.h_encode, [a.ne, a.bs]) →
                       T.is_uniformly_integrable_around
                         (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd))
                          (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                            rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                (dvec.update_at θ₀ dvec.nil idx)
                                x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         (T.softplus
                            (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                    ∀ (idx : ℕ),
                      at_idx nil idx (ID.str label.h_encode, [a.ne, a.bs]) →
                      T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd))
                         (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           ∇
                             (λ (θ₀ : T ((ID.str label.h_encode, [a.ne, a.bs]).snd)),
                                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                    (dvec.update_at θ₀ dvec.nil idx)
                                    x ⬝
                                  (T.mvn_iso_kl
                                       (T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                       (T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                     T.bernoulli_neglogpdf
                                       (T.sigmoid
                                          (T.gemm (ws.W_decode_p)
                                             (T.softplus
                                                (T.gemm (ws.W_decode)
                                                   (x *
                                                        T.sqrt
                                                          (T.exp
                                                             (T.gemm (ws.W_encode_logσ₂)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))) +
                                                      T.gemm (ws.W_encode_μ)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))))))
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                             θ₀)
                        (T.softplus
                           (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
             (true →
              ((T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           T.mvn_iso_pdf 0 1 x ⬝
                             (T.mvn_iso_kl
                                  (T.gemm (ws.W_encode_μ)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                  (T.sqrt
                                     (T.exp
                                        (T.gemm (ws.W_encode_logσ₂)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                T.bernoulli_neglogpdf
                                  (T.sigmoid
                                     (T.gemm (ws.W_decode_p)
                                        (T.softplus
                                           (T.gemm (ws.W_decode)
                                              (x *
                                                   T.sqrt
                                                     (T.exp
                                                        (T.gemm (ws.W_encode_logσ₂)
                                                           (T.softplus
                                                              (T.gemm (ws.W_encode)
                                                                 (T.get_col_range (a.bs) x_data
                                                                    (T.round (ws.batch_start))))))) +
                                                 T.gemm (ws.W_encode_μ)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))))))
                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                        (T.gemm (ws.W_encode_logσ₂)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                      T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           T.mvn_iso_pdf 0 1 x ⬝
                             (T.mvn_iso_kl
                                  (T.gemm (ws.W_encode_μ)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                  (T.sqrt
                                     (T.exp
                                        (T.gemm (ws.W_encode_logσ₂)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                T.bernoulli_neglogpdf
                                  (T.sigmoid
                                     (T.gemm (ws.W_decode_p)
                                        (T.softplus
                                           (T.gemm (ws.W_decode)
                                              (x *
                                                   T.sqrt
                                                     (T.exp
                                                        (T.gemm (ws.W_encode_logσ₂)
                                                           (T.softplus
                                                              (T.gemm (ws.W_encode)
                                                                 (T.get_col_range (a.bs) x_data
                                                                    (T.round (ws.batch_start))))))) +
                                                 T.gemm (ws.W_encode_μ)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))))))
                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                        (T.gemm (ws.W_encode_logσ₂)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                   (T.is_uniformly_integrable_around
                          (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                             ∇
                               (λ (θ₁ : T ((ID.nat 5, [a.nz, a.bs]).snd)),
                                  T.mvn_iso_pdf 0 1 x ⬝
                                    (T.mvn_iso_kl
                                         (T.gemm (ws.W_encode_μ)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                         (T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start)))))))) +
                                       T.bernoulli_neglogpdf
                                         (T.sigmoid
                                            (T.gemm (ws.W_decode_p)
                                               (T.softplus
                                                  (T.gemm (ws.W_decode)
                                                     (x *
                                                          T.sqrt
                                                            (T.exp
                                                               (T.gemm (ws.W_encode_logσ₂)
                                                                  (T.softplus
                                                                     (T.gemm (ws.W_encode)
                                                                        (T.get_col_range (a.bs) x_data
                                                                           (T.round (ws.batch_start))))))) +
                                                        T.gemm (ws.W_encode_μ)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))))))
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                               θ₀)
                          (T.gemm (ws.W_encode_logσ₂)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                        T.is_uniformly_integrable_around
                          (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                             ∇
                               (λ (θ₁ : T ((ID.nat 5, [a.nz, a.bs]).snd)),
                                  T.mvn_iso_pdf 0 1 x ⬝
                                    (T.mvn_iso_kl
                                         (T.gemm (ws.W_encode_μ)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                         (T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start)))))))) +
                                       T.bernoulli_neglogpdf
                                         (T.sigmoid
                                            (T.gemm (ws.W_decode_p)
                                               (T.softplus
                                                  (T.gemm (ws.W_decode)
                                                     (x *
                                                          T.sqrt
                                                            (T.exp
                                                               (T.gemm (ws.W_encode_logσ₂)
                                                                  (T.softplus
                                                                     (T.gemm (ws.W_encode)
                                                                        (T.get_col_range (a.bs) x_data
                                                                           (T.round (ws.batch_start))))))) +
                                                        T.gemm (ws.W_encode_μ)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))))))
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                               θ₀)
                          (T.gemm (ws.W_encode_logσ₂)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                     (∀ (idx : ℕ),
                          at_idx nil idx (ID.nat 5, [a.nz, a.bs]) →
                          T.is_uniformly_integrable_around
                            (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd))
                             (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                               rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                   (dvec.update_at θ₀ dvec.nil idx)
                                   x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                       ∀ (idx : ℕ),
                         at_idx nil idx (ID.nat 5, [a.nz, a.bs]) →
                         T.is_uniformly_integrable_around
                           (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                              ∇
                                (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)),
                                   rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                       (dvec.update_at θ₀ dvec.nil idx)
                                       x ⬝
                                     (T.mvn_iso_kl
                                          (T.gemm (ws.W_encode_μ)
                                             (T.softplus
                                                (T.gemm (ws.W_encode)
                                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                          (T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start)))))))) +
                                        T.bernoulli_neglogpdf
                                          (T.sigmoid
                                             (T.gemm (ws.W_decode_p)
                                                (T.softplus
                                                   (T.gemm (ws.W_decode)
                                                      (x *
                                                           T.sqrt
                                                             (T.exp
                                                                (T.gemm (ws.W_encode_logσ₂)
                                                                   (T.softplus
                                                                      (T.gemm (ws.W_encode)
                                                                         (T.get_col_range (a.bs) x_data
                                                                            (T.round (ws.batch_start))))))) +
                                                         T.gemm (ws.W_encode_μ)
                                                           (T.softplus
                                                              (T.gemm (ws.W_encode)
                                                                 (T.get_col_range (a.bs) x_data
                                                                    (T.round (ws.batch_start))))))))))
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                θ₀)
                           (T.gemm (ws.W_encode_logσ₂)
                              (T.softplus
                                 (T.gemm (ws.W_encode)
                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                (true →
                 ((T.is_uniformly_integrable_around
                           (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                              T.mvn_iso_pdf 0 1 x ⬝
                                (T.mvn_iso_kl
                                     (T.gemm (ws.W_encode_μ)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                     (T.sqrt
                                        (T.exp
                                           (T.gemm (ws.W_encode_logσ₂)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                   T.bernoulli_neglogpdf
                                     (T.sigmoid
                                        (T.gemm (ws.W_decode_p)
                                           (T.softplus
                                              (T.gemm (ws.W_decode)
                                                 (x *
                                                      T.sqrt
                                                        (T.exp
                                                           (T.gemm (ws.W_encode_logσ₂)
                                                              (T.softplus
                                                                 (T.gemm (ws.W_encode)
                                                                    (T.get_col_range (a.bs) x_data
                                                                       (T.round (ws.batch_start))))))) +
                                                    T.gemm (ws.W_encode_μ)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))))))
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                         T.is_uniformly_integrable_around
                           (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                              T.mvn_iso_pdf 0 1 x ⬝
                                (T.mvn_iso_kl
                                     (T.gemm (ws.W_encode_μ)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                     (T.sqrt
                                        (T.exp
                                           (T.gemm (ws.W_encode_logσ₂)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                   T.bernoulli_neglogpdf
                                     (T.sigmoid
                                        (T.gemm (ws.W_decode_p)
                                           (T.softplus
                                              (T.gemm (ws.W_decode)
                                                 (x *
                                                      T.sqrt
                                                        (T.exp
                                                           (T.gemm (ws.W_encode_logσ₂)
                                                              (T.softplus
                                                                 (T.gemm (ws.W_encode)
                                                                    (T.get_col_range (a.bs) x_data
                                                                       (T.round (ws.batch_start))))))) +
                                                    T.gemm (ws.W_encode_μ)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))))))
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                      (T.is_uniformly_integrable_around
                             (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd))
                              (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                ∇
                                  (λ (θ₁ : T ((ID.nat 6, [a.nz, a.bs]).snd)),
                                     T.mvn_iso_pdf 0 1 x ⬝
                                       (T.mvn_iso_kl
                                            (T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                            (T.sqrt
                                               (T.exp
                                                  (T.gemm (ws.W_encode_logσ₂)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start)))))))) +
                                          T.bernoulli_neglogpdf
                                            (T.sigmoid
                                               (T.gemm (ws.W_decode_p)
                                                  (T.softplus
                                                     (T.gemm (ws.W_decode)
                                                        (x *
                                                             T.sqrt
                                                               (T.exp
                                                                  (T.gemm (ws.W_encode_logσ₂)
                                                                     (T.softplus
                                                                        (T.gemm (ws.W_encode)
                                                                           (T.get_col_range (a.bs) x_data
                                                                              (T.round (ws.batch_start))))))) +
                                                           T.gemm (ws.W_encode_μ)
                                                             (T.softplus
                                                                (T.gemm (ws.W_encode)
                                                                   (T.get_col_range (a.bs) x_data
                                                                      (T.round (ws.batch_start))))))))))
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                  θ₀)
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                           T.is_uniformly_integrable_around
                             (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd))
                              (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                ∇
                                  (λ (θ₁ : T ((ID.nat 6, [a.nz, a.bs]).snd)),
                                     T.mvn_iso_pdf 0 1 x ⬝
                                       (T.mvn_iso_kl
                                            (T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                            (T.sqrt
                                               (T.exp
                                                  (T.gemm (ws.W_encode_logσ₂)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start)))))))) +
                                          T.bernoulli_neglogpdf
                                            (T.sigmoid
                                               (T.gemm (ws.W_decode_p)
                                                  (T.softplus
                                                     (T.gemm (ws.W_decode)
                                                        (x *
                                                             T.sqrt
                                                               (T.exp
                                                                  (T.gemm (ws.W_encode_logσ₂)
                                                                     (T.softplus
                                                                        (T.gemm (ws.W_encode)
                                                                           (T.get_col_range (a.bs) x_data
                                                                              (T.round (ws.batch_start))))))) +
                                                           T.gemm (ws.W_encode_μ)
                                                             (T.softplus
                                                                (T.gemm (ws.W_encode)
                                                                   (T.get_col_range (a.bs) x_data
                                                                      (T.round (ws.batch_start))))))))))
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                  θ₀)
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                        (∀ (idx : ℕ),
                             at_idx nil idx (ID.nat 6, [a.nz, a.bs]) →
                             T.is_uniformly_integrable_around
                               (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd))
                                (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                  rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                      (dvec.update_at θ₀ dvec.nil idx)
                                      x ⬝
                                    (T.mvn_iso_kl
                                         (T.gemm (ws.W_encode_μ)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                         (T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start)))))))) +
                                       T.bernoulli_neglogpdf
                                         (T.sigmoid
                                            (T.gemm (ws.W_decode_p)
                                               (T.softplus
                                                  (T.gemm (ws.W_decode)
                                                     (x *
                                                          T.sqrt
                                                            (T.exp
                                                               (T.gemm (ws.W_encode_logσ₂)
                                                                  (T.softplus
                                                                     (T.gemm (ws.W_encode)
                                                                        (T.get_col_range (a.bs) x_data
                                                                           (T.round (ws.batch_start))))))) +
                                                        T.gemm (ws.W_encode_μ)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))))))
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                               (T.exp
                                  (T.gemm (ws.W_encode_logσ₂)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                          ∀ (idx : ℕ),
                            at_idx nil idx (ID.nat 6, [a.nz, a.bs]) →
                            T.is_uniformly_integrable_around
                              (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd))
                               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                 ∇
                                   (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)),
                                      rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                          (dvec.update_at θ₀ dvec.nil idx)
                                          x ⬝
                                        (T.mvn_iso_kl
                                             (T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                             (T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start)))))))) +
                                           T.bernoulli_neglogpdf
                                             (T.sigmoid
                                                (T.gemm (ws.W_decode_p)
                                                   (T.softplus
                                                      (T.gemm (ws.W_decode)
                                                         (x *
                                                              T.sqrt
                                                                (T.exp
                                                                   (T.gemm (ws.W_encode_logσ₂)
                                                                      (T.softplus
                                                                         (T.gemm (ws.W_encode)
                                                                            (T.get_col_range (a.bs) x_data
                                                                               (T.round (ws.batch_start))))))) +
                                                            T.gemm (ws.W_encode_μ)
                                                              (T.softplus
                                                                 (T.gemm (ws.W_encode)
                                                                    (T.get_col_range (a.bs) x_data
                                                                       (T.round (ws.batch_start))))))))))
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                   θ₀)
                              (T.exp
                                 (T.gemm (ws.W_encode_logσ₂)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                   (true →
                    ((T.is_uniformly_integrable_around
                              (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                 T.mvn_iso_pdf 0 1 x ⬝
                                   (T.mvn_iso_kl
                                        (T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                        (T.sqrt
                                           (T.exp
                                              (T.gemm (ws.W_encode_logσ₂)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                      T.bernoulli_neglogpdf
                                        (T.sigmoid
                                           (T.gemm (ws.W_decode_p)
                                              (T.softplus
                                                 (T.gemm (ws.W_decode)
                                                    (x * θ₀ +
                                                       T.gemm (ws.W_encode_μ)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))))))
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                              (T.sqrt
                                 (T.exp
                                    (T.gemm (ws.W_encode_logσ₂)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                            T.is_uniformly_integrable_around
                              (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                 T.mvn_iso_pdf 0 1 x ⬝
                                   (T.mvn_iso_kl
                                        (T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                        (T.sqrt
                                           (T.exp
                                              (T.gemm (ws.W_encode_logσ₂)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                      T.bernoulli_neglogpdf
                                        (T.sigmoid
                                           (T.gemm (ws.W_decode_p)
                                              (T.softplus
                                                 (T.gemm (ws.W_decode)
                                                    (x * θ₀ +
                                                       T.gemm (ws.W_encode_μ)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))))))
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                              (T.sqrt
                                 (T.exp
                                    (T.gemm (ws.W_encode_logσ₂)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                         (T.is_uniformly_integrable_around
                                (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                   ∇
                                     (λ (θ₁ : T ((ID.str label.σ, [a.nz, a.bs]).snd)),
                                        T.mvn_iso_pdf 0 1 x ⬝
                                          (T.mvn_iso_kl
                                               (T.gemm (ws.W_encode_μ)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                               (T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start)))))))) +
                                             T.bernoulli_neglogpdf
                                               (T.sigmoid
                                                  (T.gemm (ws.W_decode_p)
                                                     (T.softplus
                                                        (T.gemm (ws.W_decode)
                                                           (x * θ₁ +
                                                              T.gemm (ws.W_encode_μ)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))))))
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                     θ₀)
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                              T.is_uniformly_integrable_around
                                (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                   ∇
                                     (λ (θ₁ : T ((ID.str label.σ, [a.nz, a.bs]).snd)),
                                        T.mvn_iso_pdf 0 1 x ⬝
                                          (T.mvn_iso_kl
                                               (T.gemm (ws.W_encode_μ)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                               (T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start)))))))) +
                                             T.bernoulli_neglogpdf
                                               (T.sigmoid
                                                  (T.gemm (ws.W_decode_p)
                                                     (T.softplus
                                                        (T.gemm (ws.W_decode)
                                                           (x * θ₁ +
                                                              T.gemm (ws.W_encode_μ)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))))))
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                     θ₀)
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                           (∀ (idx : ℕ),
                                at_idx nil idx (ID.str label.σ, [a.nz, a.bs]) →
                                T.is_uniformly_integrable_around
                                  (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                                   (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                     rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                         (dvec.update_at θ₀ dvec.nil idx)
                                         x ⬝
                                       (T.mvn_iso_kl
                                            (T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                            (T.sqrt
                                               (T.exp
                                                  (T.gemm (ws.W_encode_logσ₂)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start)))))))) +
                                          T.bernoulli_neglogpdf
                                            (T.sigmoid
                                               (T.gemm (ws.W_decode_p)
                                                  (T.softplus
                                                     (T.gemm (ws.W_decode)
                                                        (x *
                                                             T.sqrt
                                                               (T.exp
                                                                  (T.gemm (ws.W_encode_logσ₂)
                                                                     (T.softplus
                                                                        (T.gemm (ws.W_encode)
                                                                           (T.get_col_range (a.bs) x_data
                                                                              (T.round (ws.batch_start))))))) +
                                                           T.gemm (ws.W_encode_μ)
                                                             (T.softplus
                                                                (T.gemm (ws.W_encode)
                                                                   (T.get_col_range (a.bs) x_data
                                                                      (T.round (ws.batch_start))))))))))
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                  (T.sqrt
                                     (T.exp
                                        (T.gemm (ws.W_encode_logσ₂)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                             ∀ (idx : ℕ),
                               at_idx nil idx (ID.str label.σ, [a.nz, a.bs]) →
                               T.is_uniformly_integrable_around
                                 (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                                  (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                    ∇
                                      (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd)),
                                         rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                             (dvec.update_at θ₀ dvec.nil idx)
                                             x ⬝
                                           (T.mvn_iso_kl
                                                (T.gemm (ws.W_encode_μ)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                                (T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start)))))))) +
                                              T.bernoulli_neglogpdf
                                                (T.sigmoid
                                                   (T.gemm (ws.W_decode_p)
                                                      (T.softplus
                                                         (T.gemm (ws.W_decode)
                                                            (x *
                                                                 T.sqrt
                                                                   (T.exp
                                                                      (T.gemm (ws.W_encode_logσ₂)
                                                                         (T.softplus
                                                                            (T.gemm (ws.W_encode)
                                                                               (T.get_col_range (a.bs) x_data
                                                                                  (T.round (ws.batch_start))))))) +
                                                               T.gemm (ws.W_encode_μ)
                                                                 (T.softplus
                                                                    (T.gemm (ws.W_encode)
                                                                       (T.get_col_range (a.bs) x_data
                                                                          (T.round (ws.batch_start))))))))))
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                      θ₀)
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                      (true →
                       (T.is_uniformly_integrable_around
                              (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                 T.mvn_iso_pdf 0 1 x ⬝
                                   (θ₀ +
                                      T.bernoulli_neglogpdf
                                        (T.sigmoid
                                           (T.gemm (ws.W_decode_p)
                                              (T.softplus
                                                 (T.gemm (ws.W_decode)
                                                    (x *
                                                         T.sqrt
                                                           (T.exp
                                                              (T.gemm (ws.W_encode_logσ₂)
                                                                 (T.softplus
                                                                    (T.gemm (ws.W_encode)
                                                                       (T.get_col_range (a.bs) x_data
                                                                          (T.round (ws.batch_start))))))) +
                                                       T.gemm (ws.W_encode_μ)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))))))
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                              (T.mvn_iso_kl
                                 (T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                            T.is_uniformly_integrable_around
                              (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                 T.mvn_iso_pdf 0 1 x ⬝
                                   (θ₀ +
                                      T.bernoulli_neglogpdf
                                        (T.sigmoid
                                           (T.gemm (ws.W_decode_p)
                                              (T.softplus
                                                 (T.gemm (ws.W_decode)
                                                    (x *
                                                         T.sqrt
                                                           (T.exp
                                                              (T.gemm (ws.W_encode_logσ₂)
                                                                 (T.softplus
                                                                    (T.gemm (ws.W_encode)
                                                                       (T.get_col_range (a.bs) x_data
                                                                          (T.round (ws.batch_start))))))) +
                                                       T.gemm (ws.W_encode_μ)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))))))
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                              (T.mvn_iso_kl
                                 (T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                         (T.is_uniformly_integrable_around
                                (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                   ∇
                                     (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                                        T.mvn_iso_pdf 0 1 x ⬝
                                          (θ₁ +
                                             T.bernoulli_neglogpdf
                                               (T.sigmoid
                                                  (T.gemm (ws.W_decode_p)
                                                     (T.softplus
                                                        (T.gemm (ws.W_decode)
                                                           (x *
                                                                T.sqrt
                                                                  (T.exp
                                                                     (T.gemm (ws.W_encode_logσ₂)
                                                                        (T.softplus
                                                                           (T.gemm (ws.W_encode)
                                                                              (T.get_col_range (a.bs) x_data
                                                                                 (T.round (ws.batch_start))))))) +
                                                              T.gemm (ws.W_encode_μ)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))))))
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                     θ₀)
                                (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                              T.is_uniformly_integrable_around
                                (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                   ∇
                                     (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                                        T.mvn_iso_pdf 0 1 x ⬝
                                          (θ₁ +
                                             T.bernoulli_neglogpdf
                                               (T.sigmoid
                                                  (T.gemm (ws.W_decode_p)
                                                     (T.softplus
                                                        (T.gemm (ws.W_decode)
                                                           (x *
                                                                T.sqrt
                                                                  (T.exp
                                                                     (T.gemm (ws.W_encode_logσ₂)
                                                                        (T.softplus
                                                                           (T.gemm (ws.W_encode)
                                                                              (T.get_col_range (a.bs) x_data
                                                                                 (T.round (ws.batch_start))))))) +
                                                              T.gemm (ws.W_encode_μ)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))))))
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                     θ₀)
                                (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                           (∀ (idx : ℕ),
                                at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                                T.is_uniformly_integrable_around
                                  (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                                   (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                     rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                         (dvec.update_at θ₀ dvec.nil idx)
                                         x ⬝
                                       (T.mvn_iso_kl
                                            (T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                            (T.sqrt
                                               (T.exp
                                                  (T.gemm (ws.W_encode_logσ₂)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start)))))))) +
                                          T.bernoulli_neglogpdf
                                            (T.sigmoid
                                               (T.gemm (ws.W_decode_p)
                                                  (T.softplus
                                                     (T.gemm (ws.W_decode)
                                                        (x *
                                                             T.sqrt
                                                               (T.exp
                                                                  (T.gemm (ws.W_encode_logσ₂)
                                                                     (T.softplus
                                                                        (T.gemm (ws.W_encode)
                                                                           (T.get_col_range (a.bs) x_data
                                                                              (T.round (ws.batch_start))))))) +
                                                           T.gemm (ws.W_encode_μ)
                                                             (T.softplus
                                                                (T.gemm (ws.W_encode)
                                                                   (T.get_col_range (a.bs) x_data
                                                                      (T.round (ws.batch_start))))))))))
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                  (T.mvn_iso_kl
                                     (T.gemm (ws.W_encode_μ)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                     (T.sqrt
                                        (T.exp
                                           (T.gemm (ws.W_encode_logσ₂)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data
                                                       (T.round (ws.batch_start)))))))))) ∧
                             ∀ (idx : ℕ),
                               at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                               T.is_uniformly_integrable_around
                                 (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                                  (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                                    ∇
                                      (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                                         rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                             (dvec.update_at θ₀ dvec.nil idx)
                                             x ⬝
                                           (T.mvn_iso_kl
                                                (T.gemm (ws.W_encode_μ)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                                (T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start)))))))) +
                                              T.bernoulli_neglogpdf
                                                (T.sigmoid
                                                   (T.gemm (ws.W_decode_p)
                                                      (T.softplus
                                                         (T.gemm (ws.W_decode)
                                                            (x *
                                                                 T.sqrt
                                                                   (T.exp
                                                                      (T.gemm (ws.W_encode_logσ₂)
                                                                         (T.softplus
                                                                            (T.gemm (ws.W_encode)
                                                                               (T.get_col_range (a.bs) x_data
                                                                                  (T.round (ws.batch_start))))))) +
                                                               T.gemm (ws.W_encode_μ)
                                                                 (T.softplus
                                                                    (T.gemm (ws.W_encode)
                                                                       (T.get_col_range (a.bs) x_data
                                                                          (T.round (ws.batch_start))))))))))
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                                      θ₀)
                                 (T.mvn_iso_kl
                                    (T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                    (T.sqrt
                                       (T.exp
                                          (T.gemm (ws.W_encode_logσ₂)
                                             (T.softplus
                                                (T.gemm (ws.W_encode)
                                                   (T.get_col_range (a.bs) x_data
                                                      (T.round (ws.batch_start)))))))))))))) ∧
          (true →
           ((T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (T.mvn_iso_kl
                               (T.gemm (ws.W_encode_μ)
                                  (T.softplus
                                     (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                               (T.sqrt
                                  (T.exp
                                     (T.gemm (ws.W_encode_logσ₂)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              θ₀)))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.gemm (ws.W_encode_μ)
                        (T.softplus
                           (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                   T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (T.mvn_iso_kl
                               (T.gemm (ws.W_encode_μ)
                                  (T.softplus
                                     (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                               (T.sqrt
                                  (T.exp
                                     (T.gemm (ws.W_encode_logσ₂)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              θ₀)))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.gemm (ws.W_encode_μ)
                        (T.softplus
                           (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                (T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.μ, [a.nz, a.bs]).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     θ₁)))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.gemm (ws.W_encode_μ)
                          (T.softplus
                             (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
                     T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.μ, [a.nz, a.bs]).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     θ₁)))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.gemm (ws.W_encode_μ)
                          (T.softplus
                             (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                  (∀ (idx : ℕ),
                       at_idx nil idx (ID.str label.μ, [a.nz, a.bs]) →
                       T.is_uniformly_integrable_around
                         (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd))
                          (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                            rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                (dvec.update_at θ₀ dvec.nil idx)
                                x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                    ∀ (idx : ℕ),
                      at_idx nil idx (ID.str label.μ, [a.nz, a.bs]) →
                      T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd))
                         (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           ∇
                             (λ (θ₀ : T ((ID.str label.μ, [a.nz, a.bs]).snd)),
                                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                    (dvec.update_at θ₀ dvec.nil idx)
                                    x ⬝
                                  (T.mvn_iso_kl
                                       (T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                       (T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                     T.bernoulli_neglogpdf
                                       (T.sigmoid
                                          (T.gemm (ws.W_decode_p)
                                             (T.softplus
                                                (T.gemm (ws.W_decode)
                                                   (x *
                                                        T.sqrt
                                                          (T.exp
                                                             (T.gemm (ws.W_encode_logσ₂)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))) +
                                                      T.gemm (ws.W_encode_μ)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))))))
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                             θ₀)
                        (T.gemm (ws.W_encode_μ)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
             (true →
              (T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (θ₀ +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.mvn_iso_kl
                        (T.gemm (ws.W_encode_μ)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                        (T.sqrt
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                   T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (θ₀ +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.mvn_iso_kl
                        (T.gemm (ws.W_encode_μ)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                        (T.sqrt
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                (T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (θ₁ +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                     T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (θ₁ +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                  (∀ (idx : ℕ),
                       at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                       T.is_uniformly_integrable_around
                         (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                          (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                            rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                (dvec.update_at θ₀ dvec.nil idx)
                                x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         (T.mvn_iso_kl
                            (T.gemm (ws.W_encode_μ)
                               (T.softplus
                                  (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                            (T.sqrt
                               (T.exp
                                  (T.gemm (ws.W_encode_logσ₂)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                    ∀ (idx : ℕ),
                      at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                      T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                         (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           ∇
                             (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                    (dvec.update_at θ₀ dvec.nil idx)
                                    x ⬝
                                  (T.mvn_iso_kl
                                       (T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                       (T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                     T.bernoulli_neglogpdf
                                       (T.sigmoid
                                          (T.gemm (ws.W_decode_p)
                                             (T.softplus
                                                (T.gemm (ws.W_decode)
                                                   (x *
                                                        T.sqrt
                                                          (T.exp
                                                             (T.gemm (ws.W_encode_logσ₂)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))) +
                                                      T.gemm (ws.W_encode_μ)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))))))
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                             θ₀)
                        (T.mvn_iso_kl
                           (T.gemm (ws.W_encode_μ)
                              (T.softplus
                                 (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                           (T.sqrt
                              (T.exp
                                 (T.gemm (ws.W_encode_logσ₂)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))))))
---------------------------------------
a : arch,
ws : weights a,
x_data : T [a.n_in, a.n_x]
⊢ (T.is_uniformly_integrable_around
         (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
            T.mvn_iso_pdf 0 1 x ⬝
              (T.mvn_iso_kl
                   (T.gemm (ws.W_encode_μ)
                      (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                   (T.sqrt
                      (T.exp
                         (T.gemm (ws.W_encode_logσ₂)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                 T.bernoulli_neglogpdf
                   (T.sigmoid
                      (T.gemm θ₀
                         (T.softplus
                            (T.gemm (ws.W_decode)
                               (x *
                                    T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                  T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
         (ws.W_decode_p) ∧
       T.is_uniformly_integrable_around
         (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
            T.mvn_iso_pdf 0 1 x ⬝
              (T.mvn_iso_kl
                   (T.gemm (ws.W_encode_μ)
                      (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                   (T.sqrt
                      (T.exp
                         (T.gemm (ws.W_encode_logσ₂)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                 T.bernoulli_neglogpdf
                   (T.sigmoid
                      (T.gemm θ₀
                         (T.softplus
                            (T.gemm (ws.W_decode)
                               (x *
                                    T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                  T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
         (ws.W_decode_p)) ∧
    (T.is_uniformly_integrable_around
           (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd))
            (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
              ∇
                (λ (θ₁ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd)),
                   T.mvn_iso_pdf 0 1 x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm θ₁
                                (T.softplus
                                   (T.gemm (ws.W_decode)
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                θ₀)
           (ws.W_decode_p) ∧
         T.is_uniformly_integrable_around
           (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd))
            (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
              ∇
                (λ (θ₁ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd)),
                   T.mvn_iso_pdf 0 1 x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm θ₁
                                (T.softplus
                                   (T.gemm (ws.W_decode)
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                θ₀)
           (ws.W_decode_p)) ∧
      (∀ (idx : ℕ),
           at_idx nil idx (ID.str label.W_decode_p, [a.n_in, a.nd]) →
           T.is_uniformly_integrable_around
             (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd))
              (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                  (T.mvn_iso_kl
                       (T.gemm (ws.W_encode_μ)
                          (T.softplus
                             (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                       (T.sqrt
                          (T.exp
                             (T.gemm (ws.W_encode_logσ₂)
                                (T.softplus
                                   (T.gemm (ws.W_encode)
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                     T.bernoulli_neglogpdf
                       (T.sigmoid
                          (T.gemm (ws.W_decode_p)
                             (T.softplus
                                (T.gemm (ws.W_decode)
                                   (x *
                                        T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                      T.gemm (ws.W_encode_μ)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
             (ws.W_decode_p)) ∧
        ∀ (idx : ℕ),
          at_idx nil idx (ID.str label.W_decode_p, [a.n_in, a.nd]) →
          T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd))
             (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               ∇
                 (λ (θ₀ : T ((ID.str label.W_decode_p, [a.n_in, a.nd]).snd)),
                    rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                      (T.mvn_iso_kl
                           (T.gemm (ws.W_encode_μ)
                              (T.softplus
                                 (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                           (T.sqrt
                              (T.exp
                                 (T.gemm (ws.W_encode_logσ₂)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                         T.bernoulli_neglogpdf
                           (T.sigmoid
                              (T.gemm (ws.W_decode_p)
                                 (T.softplus
                                    (T.gemm (ws.W_decode)
                                       (x *
                                            T.sqrt
                                              (T.exp
                                                 (T.gemm (ws.W_encode_logσ₂)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))) +
                                          T.gemm (ws.W_encode_μ)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                 θ₀)
            (ws.W_decode_p)
--------------------------------
a : arch,
ws : weights a,
x_data : T [a.n_in, a.n_x]
⊢ ((T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd))
             (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               T.mvn_iso_pdf 0 1 x ⬝
                 (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                    T.bernoulli_neglogpdf
                      (T.sigmoid
                         (T.gemm (ws.W_decode_p)
                            (T.softplus
                               (T.gemm (ws.W_decode)
                                  (x *
                                       T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                     T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
            (ws.W_encode_logσ₂) ∧
          T.is_uniformly_integrable_around
            (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd))
             (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
               T.mvn_iso_pdf 0 1 x ⬝
                 (T.mvn_iso_kl
                      (T.gemm (ws.W_encode_μ)
                         (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                      (T.sqrt
                         (T.exp
                            (T.gemm (ws.W_encode_logσ₂)
                               (T.softplus
                                  (T.gemm (ws.W_encode)
                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                    T.bernoulli_neglogpdf
                      (T.sigmoid
                         (T.gemm (ws.W_decode_p)
                            (T.softplus
                               (T.gemm (ws.W_decode)
                                  (x *
                                       T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                     T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
            (ws.W_encode_logσ₂)) ∧
       (T.is_uniformly_integrable_around
              (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd))
               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                 ∇
                   (λ (θ₁ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd)),
                      T.mvn_iso_pdf 0 1 x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   θ₀)
              (ws.W_encode_logσ₂) ∧
            T.is_uniformly_integrable_around
              (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd))
               (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                 ∇
                   (λ (θ₁ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd)),
                      T.mvn_iso_pdf 0 1 x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   θ₀)
              (ws.W_encode_logσ₂)) ∧
         (∀ (idx : ℕ),
              at_idx nil idx (ID.str label.W_encode_logσ₂, [a.nz, a.ne]) →
              T.is_uniformly_integrable_around
                (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd))
                 (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                   rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx) x ⬝
                     (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                        T.bernoulli_neglogpdf
                          (T.sigmoid
                             (T.gemm (ws.W_decode_p)
                                (T.softplus
                                   (T.gemm (ws.W_decode)
                                      (x *
                                           T.sqrt
                                             (T.exp
                                                (T.gemm (ws.W_encode_logσ₂)
                                                   (T.softplus
                                                      (T.gemm (ws.W_encode)
                                                         (T.get_col_range (a.bs) x_data
                                                            (T.round (ws.batch_start))))))) +
                                         T.gemm (ws.W_encode_μ)
                                           (T.softplus
                                              (T.gemm (ws.W_encode)
                                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                (ws.W_encode_logσ₂)) ∧
           ∀ (idx : ℕ),
             at_idx nil idx (ID.str label.W_encode_logσ₂, [a.nz, a.ne]) →
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd))
                (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  ∇
                    (λ (θ₀ : T ((ID.str label.W_encode_logσ₂, [a.nz, a.ne]).snd)),
                       rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                           x ⬝
                         (T.mvn_iso_kl
                              (T.gemm (ws.W_encode_μ)
                                 (T.softplus
                                    (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                              (T.sqrt
                                 (T.exp
                                    (T.gemm (ws.W_encode_logσ₂)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                            T.bernoulli_neglogpdf
                              (T.sigmoid
                                 (T.gemm (ws.W_decode_p)
                                    (T.softplus
                                       (T.gemm (ws.W_decode)
                                          (x *
                                               T.sqrt
                                                 (T.exp
                                                    (T.gemm (ws.W_encode_logσ₂)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))) +
                                             T.gemm (ws.W_encode_μ)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                    θ₀)
               (ws.W_encode_logσ₂)) ∧
    (true →
     ((T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (T.mvn_iso_kl
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.gemm (ws.W_encode_logσ₂)
                  (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
             T.is_uniformly_integrable_around
               (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                  T.mvn_iso_pdf 0 1 x ⬝
                    (T.mvn_iso_kl
                         (T.gemm (ws.W_encode_μ)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                       T.bernoulli_neglogpdf
                         (T.sigmoid
                            (T.gemm (ws.W_decode_p)
                               (T.softplus
                                  (T.gemm (ws.W_decode)
                                     (x *
                                          T.sqrt
                                            (T.exp
                                               (T.gemm (ws.W_encode_logσ₂)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) +
                                        T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
               (T.gemm (ws.W_encode_logσ₂)
                  (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
          (T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.nat 5, [a.nz, a.bs]).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.gemm (ws.W_encode_logσ₂)
                    (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))) ∧
               T.is_uniformly_integrable_around
                 (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                    ∇
                      (λ (θ₁ : T ((ID.nat 5, [a.nz, a.bs]).snd)),
                         T.mvn_iso_pdf 0 1 x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      θ₀)
                 (T.gemm (ws.W_encode_logσ₂)
                    (T.softplus (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
            (∀ (idx : ℕ),
                 at_idx nil idx (ID.nat 5, [a.nz, a.bs]) →
                 T.is_uniformly_integrable_around
                   (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                      rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                          x ⬝
                        (T.mvn_iso_kl
                             (T.gemm (ws.W_encode_μ)
                                (T.softplus
                                   (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                             (T.sqrt
                                (T.exp
                                   (T.gemm (ws.W_encode_logσ₂)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                           T.bernoulli_neglogpdf
                             (T.sigmoid
                                (T.gemm (ws.W_decode_p)
                                   (T.softplus
                                      (T.gemm (ws.W_decode)
                                         (x *
                                              T.sqrt
                                                (T.exp
                                                   (T.gemm (ws.W_encode_logσ₂)
                                                      (T.softplus
                                                         (T.gemm (ws.W_encode)
                                                            (T.get_col_range (a.bs) x_data
                                                               (T.round (ws.batch_start))))))) +
                                            T.gemm (ws.W_encode_μ)
                                              (T.softplus
                                                 (T.gemm (ws.W_encode)
                                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                   (T.gemm (ws.W_encode_logσ₂)
                      (T.softplus
                         (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
              ∀ (idx : ℕ),
                at_idx nil idx (ID.nat 5, [a.nz, a.bs]) →
                T.is_uniformly_integrable_around
                  (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                     ∇
                       (λ (θ₀ : T ((ID.nat 5, [a.nz, a.bs]).snd)),
                          rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                              x ⬝
                            (T.mvn_iso_kl
                                 (T.gemm (ws.W_encode_μ)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                 (T.sqrt
                                    (T.exp
                                       (T.gemm (ws.W_encode_logσ₂)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                               T.bernoulli_neglogpdf
                                 (T.sigmoid
                                    (T.gemm (ws.W_decode_p)
                                       (T.softplus
                                          (T.gemm (ws.W_decode)
                                             (x *
                                                  T.sqrt
                                                    (T.exp
                                                       (T.gemm (ws.W_encode_logσ₂)
                                                          (T.softplus
                                                             (T.gemm (ws.W_encode)
                                                                (T.get_col_range (a.bs) x_data
                                                                   (T.round (ws.batch_start))))))) +
                                                T.gemm (ws.W_encode_μ)
                                                  (T.softplus
                                                     (T.gemm (ws.W_encode)
                                                        (T.get_col_range (a.bs) x_data
                                                           (T.round (ws.batch_start))))))))))
                                 (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                       θ₀)
                  (T.gemm (ws.W_encode_logσ₂)
                     (T.softplus
                        (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
       (true →
        ((T.is_uniformly_integrable_around
                  (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                     T.mvn_iso_pdf 0 1 x ⬝
                       (T.mvn_iso_kl
                            (T.gemm (ws.W_encode_μ)
                               (T.softplus
                                  (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                            (T.sqrt
                               (T.exp
                                  (T.gemm (ws.W_encode_logσ₂)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                          T.bernoulli_neglogpdf
                            (T.sigmoid
                               (T.gemm (ws.W_decode_p)
                                  (T.softplus
                                     (T.gemm (ws.W_decode)
                                        (x *
                                             T.sqrt
                                               (T.exp
                                                  (T.gemm (ws.W_encode_logσ₂)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start))))))) +
                                           T.gemm (ws.W_encode_μ)
                                             (T.softplus
                                                (T.gemm (ws.W_encode)
                                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                  (T.exp
                     (T.gemm (ws.W_encode_logσ₂)
                        (T.softplus
                           (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                T.is_uniformly_integrable_around
                  (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                     T.mvn_iso_pdf 0 1 x ⬝
                       (T.mvn_iso_kl
                            (T.gemm (ws.W_encode_μ)
                               (T.softplus
                                  (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                            (T.sqrt
                               (T.exp
                                  (T.gemm (ws.W_encode_logσ₂)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                          T.bernoulli_neglogpdf
                            (T.sigmoid
                               (T.gemm (ws.W_decode_p)
                                  (T.softplus
                                     (T.gemm (ws.W_decode)
                                        (x *
                                             T.sqrt
                                               (T.exp
                                                  (T.gemm (ws.W_encode_logσ₂)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start))))))) +
                                           T.gemm (ws.W_encode_μ)
                                             (T.softplus
                                                (T.gemm (ws.W_encode)
                                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                  (T.exp
                     (T.gemm (ws.W_encode_logσ₂)
                        (T.softplus
                           (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
             (T.is_uniformly_integrable_around
                    (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                       ∇
                         (λ (θ₁ : T ((ID.nat 6, [a.nz, a.bs]).snd)),
                            T.mvn_iso_pdf 0 1 x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         θ₀)
                    (T.exp
                       (T.gemm (ws.W_encode_logσ₂)
                          (T.softplus
                             (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))) ∧
                  T.is_uniformly_integrable_around
                    (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                       ∇
                         (λ (θ₁ : T ((ID.nat 6, [a.nz, a.bs]).snd)),
                            T.mvn_iso_pdf 0 1 x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         θ₀)
                    (T.exp
                       (T.gemm (ws.W_encode_logσ₂)
                          (T.softplus
                             (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
               (∀ (idx : ℕ),
                    at_idx nil idx (ID.nat 6, [a.nz, a.bs]) →
                    T.is_uniformly_integrable_around
                      (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                         rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd) (dvec.update_at θ₀ dvec.nil idx)
                             x ⬝
                           (T.mvn_iso_kl
                                (T.gemm (ws.W_encode_μ)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                (T.sqrt
                                   (T.exp
                                      (T.gemm (ws.W_encode_logσ₂)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                              T.bernoulli_neglogpdf
                                (T.sigmoid
                                   (T.gemm (ws.W_decode_p)
                                      (T.softplus
                                         (T.gemm (ws.W_decode)
                                            (x *
                                                 T.sqrt
                                                   (T.exp
                                                      (T.gemm (ws.W_encode_logσ₂)
                                                         (T.softplus
                                                            (T.gemm (ws.W_encode)
                                                               (T.get_col_range (a.bs) x_data
                                                                  (T.round (ws.batch_start))))))) +
                                               T.gemm (ws.W_encode_μ)
                                                 (T.softplus
                                                    (T.gemm (ws.W_encode)
                                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                      (T.exp
                         (T.gemm (ws.W_encode_logσ₂)
                            (T.softplus
                               (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                 ∀ (idx : ℕ),
                   at_idx nil idx (ID.nat 6, [a.nz, a.bs]) →
                   T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)) (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        ∇
                          (λ (θ₀ : T ((ID.nat 6, [a.nz, a.bs]).snd)),
                             rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                 (dvec.update_at θ₀ dvec.nil idx)
                                 x ⬝
                               (T.mvn_iso_kl
                                    (T.gemm (ws.W_encode_μ)
                                       (T.softplus
                                          (T.gemm (ws.W_encode)
                                             (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                    (T.sqrt
                                       (T.exp
                                          (T.gemm (ws.W_encode_logσ₂)
                                             (T.softplus
                                                (T.gemm (ws.W_encode)
                                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                  T.bernoulli_neglogpdf
                                    (T.sigmoid
                                       (T.gemm (ws.W_decode_p)
                                          (T.softplus
                                             (T.gemm (ws.W_decode)
                                                (x *
                                                     T.sqrt
                                                       (T.exp
                                                          (T.gemm (ws.W_encode_logσ₂)
                                                             (T.softplus
                                                                (T.gemm (ws.W_encode)
                                                                   (T.get_col_range (a.bs) x_data
                                                                      (T.round (ws.batch_start))))))) +
                                                   T.gemm (ws.W_encode_μ)
                                                     (T.softplus
                                                        (T.gemm (ws.W_encode)
                                                           (T.get_col_range (a.bs) x_data
                                                              (T.round (ws.batch_start))))))))))
                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                          θ₀)
                     (T.exp
                        (T.gemm (ws.W_encode_logσ₂)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
          (true →
           ((T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (T.mvn_iso_kl
                               (T.gemm (ws.W_encode_μ)
                                  (T.softplus
                                     (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                               (T.sqrt
                                  (T.exp
                                     (T.gemm (ws.W_encode_logσ₂)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x * θ₀ +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.sqrt
                        (T.exp
                           (T.gemm (ws.W_encode_logσ₂)
                              (T.softplus
                                 (T.gemm (ws.W_encode)
                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                   T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (T.mvn_iso_kl
                               (T.gemm (ws.W_encode_μ)
                                  (T.softplus
                                     (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                               (T.sqrt
                                  (T.exp
                                     (T.gemm (ws.W_encode_logσ₂)
                                        (T.softplus
                                           (T.gemm (ws.W_encode)
                                              (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x * θ₀ +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.sqrt
                        (T.exp
                           (T.gemm (ws.W_encode_logσ₂)
                              (T.softplus
                                 (T.gemm (ws.W_encode)
                                    (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                (T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.σ, [a.nz, a.bs]).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x * θ₁ +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.sqrt
                          (T.exp
                             (T.gemm (ws.W_encode_logσ₂)
                                (T.softplus
                                   (T.gemm (ws.W_encode)
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) ∧
                     T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.σ, [a.nz, a.bs]).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (T.mvn_iso_kl
                                      (T.gemm (ws.W_encode_μ)
                                         (T.softplus
                                            (T.gemm (ws.W_encode)
                                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                      (T.sqrt
                                         (T.exp
                                            (T.gemm (ws.W_encode_logσ₂)
                                               (T.softplus
                                                  (T.gemm (ws.W_encode)
                                                     (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x * θ₁ +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.sqrt
                          (T.exp
                             (T.gemm (ws.W_encode_logσ₂)
                                (T.softplus
                                   (T.gemm (ws.W_encode)
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                  (∀ (idx : ℕ),
                       at_idx nil idx (ID.str label.σ, [a.nz, a.bs]) →
                       T.is_uniformly_integrable_around
                         (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                          (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                            rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                (dvec.update_at θ₀ dvec.nil idx)
                                x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         (T.sqrt
                            (T.exp
                               (T.gemm (ws.W_encode_logσ₂)
                                  (T.softplus
                                     (T.gemm (ws.W_encode)
                                        (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                    ∀ (idx : ℕ),
                      at_idx nil idx (ID.str label.σ, [a.nz, a.bs]) →
                      T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd))
                         (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           ∇
                             (λ (θ₀ : T ((ID.str label.σ, [a.nz, a.bs]).snd)),
                                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                    (dvec.update_at θ₀ dvec.nil idx)
                                    x ⬝
                                  (T.mvn_iso_kl
                                       (T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                       (T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                     T.bernoulli_neglogpdf
                                       (T.sigmoid
                                          (T.gemm (ws.W_decode_p)
                                             (T.softplus
                                                (T.gemm (ws.W_decode)
                                                   (x *
                                                        T.sqrt
                                                          (T.exp
                                                             (T.gemm (ws.W_encode_logσ₂)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))) +
                                                      T.gemm (ws.W_encode_μ)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))))))
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                             θ₀)
                        (T.sqrt
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
             (true →
              (T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (θ₀ +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.mvn_iso_kl
                        (T.gemm (ws.W_encode_μ)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                        (T.sqrt
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                   T.is_uniformly_integrable_around
                     (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                      (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                        T.mvn_iso_pdf 0 1 x ⬝
                          (θ₀ +
                             T.bernoulli_neglogpdf
                               (T.sigmoid
                                  (T.gemm (ws.W_decode_p)
                                     (T.softplus
                                        (T.gemm (ws.W_decode)
                                           (x *
                                                T.sqrt
                                                  (T.exp
                                                     (T.gemm (ws.W_encode_logσ₂)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))) +
                                              T.gemm (ws.W_encode_μ)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))))
                               (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                     (T.mvn_iso_kl
                        (T.gemm (ws.W_encode_μ)
                           (T.softplus
                              (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                        (T.sqrt
                           (T.exp
                              (T.gemm (ws.W_encode_logσ₂)
                                 (T.softplus
                                    (T.gemm (ws.W_encode)
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                (T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (θ₁ +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))))) ∧
                     T.is_uniformly_integrable_around
                       (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                        (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                          ∇
                            (λ (θ₁ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                               T.mvn_iso_pdf 0 1 x ⬝
                                 (θ₁ +
                                    T.bernoulli_neglogpdf
                                      (T.sigmoid
                                         (T.gemm (ws.W_decode_p)
                                            (T.softplus
                                               (T.gemm (ws.W_decode)
                                                  (x *
                                                       T.sqrt
                                                         (T.exp
                                                            (T.gemm (ws.W_encode_logσ₂)
                                                               (T.softplus
                                                                  (T.gemm (ws.W_encode)
                                                                     (T.get_col_range (a.bs) x_data
                                                                        (T.round (ws.batch_start))))))) +
                                                     T.gemm (ws.W_encode_μ)
                                                       (T.softplus
                                                          (T.gemm (ws.W_encode)
                                                             (T.get_col_range (a.bs) x_data
                                                                (T.round (ws.batch_start))))))))))
                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                            θ₀)
                       (T.mvn_iso_kl
                          (T.gemm (ws.W_encode_μ)
                             (T.softplus
                                (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                          (T.sqrt
                             (T.exp
                                (T.gemm (ws.W_encode_logσ₂)
                                   (T.softplus
                                      (T.gemm (ws.W_encode)
                                         (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                  (∀ (idx : ℕ),
                       at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                       T.is_uniformly_integrable_around
                         (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                          (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                            rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                (dvec.update_at θ₀ dvec.nil idx)
                                x ⬝
                              (T.mvn_iso_kl
                                   (T.gemm (ws.W_encode_μ)
                                      (T.softplus
                                         (T.gemm (ws.W_encode)
                                            (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                   (T.sqrt
                                      (T.exp
                                         (T.gemm (ws.W_encode_logσ₂)
                                            (T.softplus
                                               (T.gemm (ws.W_encode)
                                                  (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                 T.bernoulli_neglogpdf
                                   (T.sigmoid
                                      (T.gemm (ws.W_decode_p)
                                         (T.softplus
                                            (T.gemm (ws.W_decode)
                                               (x *
                                                    T.sqrt
                                                      (T.exp
                                                         (T.gemm (ws.W_encode_logσ₂)
                                                            (T.softplus
                                                               (T.gemm (ws.W_encode)
                                                                  (T.get_col_range (a.bs) x_data
                                                                     (T.round (ws.batch_start))))))) +
                                                  T.gemm (ws.W_encode_μ)
                                                    (T.softplus
                                                       (T.gemm (ws.W_encode)
                                                          (T.get_col_range (a.bs) x_data
                                                             (T.round (ws.batch_start))))))))))
                                   (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                         (T.mvn_iso_kl
                            (T.gemm (ws.W_encode_μ)
                               (T.softplus
                                  (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                            (T.sqrt
                               (T.exp
                                  (T.gemm (ws.W_encode_logσ₂)
                                     (T.softplus
                                        (T.gemm (ws.W_encode)
                                           (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))) ∧
                    ∀ (idx : ℕ),
                      at_idx nil idx (ID.str label.encoding_loss, nil ℕ) →
                      T.is_uniformly_integrable_around
                        (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd))
                         (x : T ((ID.str label.ε, [a.nz, a.bs]).snd)),
                           ∇
                             (λ (θ₀ : T ((ID.str label.encoding_loss, nil ℕ).snd)),
                                rand.pdf.mvn_iso_std ((ID.str label.ε, [a.nz, a.bs]).snd)
                                    (dvec.update_at θ₀ dvec.nil idx)
                                    x ⬝
                                  (T.mvn_iso_kl
                                       (T.gemm (ws.W_encode_μ)
                                          (T.softplus
                                             (T.gemm (ws.W_encode)
                                                (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                                       (T.sqrt
                                          (T.exp
                                             (T.gemm (ws.W_encode_logσ₂)
                                                (T.softplus
                                                   (T.gemm (ws.W_encode)
                                                      (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))) +
                                     T.bernoulli_neglogpdf
                                       (T.sigmoid
                                          (T.gemm (ws.W_decode_p)
                                             (T.softplus
                                                (T.gemm (ws.W_decode)
                                                   (x *
                                                        T.sqrt
                                                          (T.exp
                                                             (T.gemm (ws.W_encode_logσ₂)
                                                                (T.softplus
                                                                   (T.gemm (ws.W_encode)
                                                                      (T.get_col_range (a.bs) x_data
                                                                         (T.round (ws.batch_start))))))) +
                                                      T.gemm (ws.W_encode_μ)
                                                        (T.softplus
                                                           (T.gemm (ws.W_encode)
                                                              (T.get_col_range (a.bs) x_data
                                                                 (T.round (ws.batch_start))))))))))
                                       (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))
                             θ₀)
                        (T.mvn_iso_kl
                           (T.gemm (ws.W_encode_μ)
                              (T.softplus
                                 (T.gemm (ws.W_encode) (T.get_col_range (a.bs) x_data (T.round (ws.batch_start))))))
                           (T.sqrt
                              (T.exp
                                 (T.gemm (ws.W_encode_logσ₂)
                                    (T.softplus
                                       (T.gemm (ws.W_encode)
                                          (T.get_col_range (a.bs) x_data (T.round (ws.batch_start)))))))))))))

real	1m22.064s
user	2m15.744s
sys	0m0.576s
dselsam@gigue:~/projects/lean/apps/certigrad$